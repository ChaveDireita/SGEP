<script>
    const lock = {
        create: true,
        edit: true
    }
    $('#form-create').submit(function (e) {
        e.preventDefault()
        if ($(this).valid() && lock.create) {
            lock.create = false;
            loading.show();
            var color = 'success';
            const formData = new FormData(document.querySelector('#form-create'));
            $('#modal-create').modal('hide');
            fetch('/' + controller + '/Create', {
                method: 'post',
                body: formData
            })
            .then(res => {
                color = res.ok ? 'success' : 'danger';
                return res.text()
            })
            .then(text => 
            {
                $('#modal-create').modal('hide');
                list(_search());
                showAlert(text, color);
                lock.create = true;
                loading.hide();
            });
        }
    });

    $('#form-edit').submit(function (e) {
        e.preventDefault()
        if ($(this).valid() && lock.edit) {
            lock.edit = false;
            loading.show();
            var color = 'success';
            const formData = new FormData(document.querySelector('#form-edit'));
            $('#modal-edit').modal('hide');
            fetch('/' + controller + '/Edit', {
                method: 'post',
                body: formData
            })
            .then(res => {
                color = res.ok ? 'success' : 'danger';
                return res.text()
            })
            .then(text => 
            {
                list(_search());
                showAlert(text, color);
                lock.edit = true;
                loading.hide();
            });
        }
    });
</script>